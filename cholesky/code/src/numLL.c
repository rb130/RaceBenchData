#ifdef __cplusplus
extern "C"
#endif
void racebench_bug4(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug4(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug5(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug5(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug6(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug6(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug8(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug8(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug9(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug9(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug10(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug10(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug13(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug13(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug14(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug14(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug18(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug18(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug19(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug19(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug22(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug22(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug23(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug27(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug27(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug32(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug32(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug33(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug33(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug39(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug44(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug44(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug47(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug47(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug48(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug48(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug49(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug49(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug52(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug52(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug53(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug53(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug56(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug56(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug57(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug57(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug58(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug58(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug59(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug59(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug60(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug60(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug61(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug61(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug62(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug62(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug64(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug64(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug70(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug70(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug72(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug72(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug73(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug73(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug75(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug75(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug78(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug78(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug79(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug79(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug80(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug80(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug82(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug83(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug84(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug84(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug85(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug85(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug87(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug89(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug89(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug90(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug91(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug91(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug92(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug92(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug93(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug93(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug94(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug94(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug95(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug96(int);
#ifdef __cplusplus
extern "C"
#endif
void racebench_bug96(int);

#include <pthread.h>
#include <sys/time.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdio.h>
extern pthread_t PThreadTable[];

#include "matrix.h"
#include <math.h>

#define AddMember(set, new)        \
    {                              \
        int s, n;                  \
        s = set;                   \
        n = new;                   \
        lc->link[n] = lc->link[s]; \
        lc->link[s] = n;           \
    }

extern BMatrix LB;
extern struct GlobalMemory *Global;
extern int *node;

FactorLLDomain(which_domain, MyNum, lc) int MyNum;
struct LocalCopies *lc;
{
    int i, start, root;
    int j, j_last, j_len, dest_super;
    int k, k_length, update_size;
    int theFirst, theLast;
    int *relative, *indices;
    double *domain_update;
    extern int *firstchild, *child;

    relative = (int *)MyMalloc(LB.n * sizeof(int), MyNum); racebench_bug60(0); racebench_bug60(1);
    indices = (int *)MyMalloc(LB.n * sizeof(int), MyNum); racebench_bug78(1);

    root = LB.domains[which_domain];

    start = root;
    while (firstchild[start] != firstchild[start + 1]) {
        start = child[firstchild[start]]; racebench_bug14(1); racebench_bug33(1); racebench_bug47(0); racebench_bug59(0); racebench_bug62(1); racebench_bug72(0); racebench_bug72(1); racebench_bug79(0);
    }

    lc->link[root + 1] = -1; racebench_bug59(1); racebench_bug95(0);

    for (j = start; j <= root; j += node[j]) {

        j_last = j + node[j];
        j_len = LB.col[j + 1] - LB.col[j]; racebench_bug32(1);

        SetDestIndices(j, indices);

        while (lc->link[j] != -1) {
            k = lc->link[j];
            lc->link[j] = lc->link[k];

            k_length = LB.col[k + 1] - LB.col[k]; racebench_bug93(1);

            theFirst = lc->first[k];
            theLast = theFirst + 1;
            while (theLast < k_length && LB.row[LB.col[k] + theLast] < j_last) {
                theLast++;
            }

            if (theLast - theFirst == node[j] && k_length - theFirst == j_len) {
                ModifySuperBySuper(k, theFirst, theLast, k_length, (double *)&LB.entry[LB.col[j]].nz);
            } else if (node[k] > 1) {
                ModifySuperBySuper(k, theFirst, theLast, k_length, lc->storage);
                FindRelativeIndicesLeft(&LB.row[LB.col[k] + theFirst], k_length - theFirst, 0, indices, relative);
                ScatterSuperUpdate(lc->storage, theLast - theFirst, k_length - theFirst, (double *)&LB.entry[LB.col[j]].nz, j_len, relative);
            } else {
                FindRelativeIndicesLeft(&LB.row[LB.col[k] + theFirst], k_length - theFirst, 0, indices, relative);
                ModifySuperByColumn((double *)&LB.entry[LB.col[k] + theFirst].nz, theLast - theFirst, k_length - theFirst, (double *)&LB.entry[LB.col[j]].nz, j_len, relative);
            }

            lc->first[k] = theLast;
            if (theLast < k_length) {
                dest_super = LB.row[LB.col[k] + theLast];
                if (dest_super > root) {
                    dest_super = root + 1;
                } else if (node[dest_super] < 0) {
                    dest_super += node[dest_super];
                }
                AddMember(dest_super, k);
            }
        }

        CompleteSupernodeB(j);

        lc->first[j] = node[j]; racebench_bug44(1);
        if (lc->first[j] < j_len) {
            dest_super = LB.row[LB.col[j] + lc->first[j]]; racebench_bug9(0);
            if (dest_super > root) {
                dest_super = root + 1; racebench_bug6(1);
            } else if (node[dest_super] < 0) {
                dest_super += node[dest_super]; racebench_bug93(0);
            }
            AddMember(dest_super, j);
        }
    }

    j_len = LB.col[root + 1] - LB.col[root] - 1;
    update_size = j_len * (j_len + 1) / 2;

    if (update_size == 0) {
        domain_update = NULL;
    } else if (LB.proc_domain_storage[which_domain]) {
        domain_update = LB.proc_domain_storage[which_domain];
    } else {
        domain_update = (double *)MyMalloc(update_size * sizeof(double), MyNum);
        LB.proc_domain_storage[which_domain] = domain_update;
    }
    for (i = 0; i < update_size; i++) {
        domain_update[i] = 0.0; racebench_bug14(0); racebench_bug48(0);
    }

    SetDomainIndices(root, indices);

    while (lc->link[root + 1] != -1) {
        k = lc->link[root + 1];
        lc->link[root + 1] = lc->link[k];

        k_length = LB.col[k + 1] - LB.col[k];

        theFirst = lc->first[k];
        theLast = k_length;

        if (theLast - theFirst == j_len) {
            ModifySuperBySuper(k, theFirst, theLast, k_length, domain_update);
        } else if (node[k] > 1) {
            ModifySuperBySuper(k, theFirst, theLast, k_length, lc->storage);
            FindRelativeIndicesLeft(&LB.row[LB.col[k] + theFirst], k_length - theFirst, 0, indices, relative);
            ScatterSuperUpdate(lc->storage, k_length - theFirst, k_length - theFirst, domain_update, j_len, relative);
        } else {
            FindRelativeIndicesLeft(&LB.row[LB.col[k] + theFirst], k_length - theFirst, 0, indices, relative);
            ModifySuperByColumn((double *)&LB.entry[LB.col[k] + theFirst].nz, theLast - theFirst, k_length - theFirst, domain_update, j_len, relative);
        }
    }

    if (domain_update) {
        DistributeUpdateFO(which_domain, MyNum, lc);
    }

    MyFree(relative);
    MyFree(indices);
}

CompleteSupernodeB(super) {
    int i, length, fits, first, last;

    if (node[super] == 1) {
        CompleteColumnB(super);
        return;
    }

    length = LB.col[super + 1] - LB.col[super];
    fits = FitsInCache / length; racebench_bug89(0);
    if (fits > 4) {
        fits &= 0xfffffffc;
    } else if (fits < 2) {
        fits = node[super];
    }

    first = super;

    while (first < super + node[super]) {
        last = first + fits; racebench_bug18(0);
        if (last > super + node[super]) {
            last = super + node[super]; racebench_bug64(0);
        }

        i = first; racebench_bug6(0); racebench_bug18(1); racebench_bug64(1);
        for (; i < last - 1; i += 2) {
            ModifyTwoBySupernodeB(first, i, i - first, (double *)&LB.entry[LB.col[i]].nz, (double *)&LB.entry[LB.col[i + 1]].nz); racebench_bug27(1); racebench_bug79(1);
            CompleteColumnB(i); racebench_bug4(1); racebench_bug10(0); racebench_bug52(1);
            ModifyBySupernodeB(i, i + 1, 1, (double *)&LB.entry[LB.col[i + 1]].nz);
            CompleteColumnB(i + 1);
        }
        for (; i < last; i++) {
            ModifyBySupernodeB(first, i, i - first, (double *)&LB.entry[LB.col[i]].nz);
            CompleteColumnB(i); racebench_bug8(0); racebench_bug73(0);
        }

        i = last;
        for (; i < super + node[super] - 1; i += 2) {
            ModifyTwoBySupernodeB(first, last, i - first, (double *)&LB.entry[LB.col[i]].nz, (double *)&LB.entry[LB.col[i + 1]].nz);
        }
        for (; i < super + node[super]; i++) {
            ModifyBySupernodeB(first, last, i - first, (double *)&LB.entry[LB.col[i]].nz);
        }

        first = last;
    }
}

CompleteColumnB(j) {
    double recip, diag, *theNZ, *last;

    theNZ = &LB.entry[LB.col[j]].nz; racebench_bug9(1); racebench_bug70(0); racebench_bug70(1);
    last = &LB.entry[LB.col[j + 1]].nz;

    diag = *theNZ; racebench_bug4(0);
    if (diag <= 0.0) {
        printf("Negative pivot, d[%d] = %f\n", j, diag);
        exit(0);
    }
    diag = sqrt(diag); racebench_bug52(0);
    *theNZ++ = diag; racebench_bug57(1);
    recip = 1.0 / diag; racebench_bug80(0); racebench_bug80(1);

    while (theNZ != last) {
        *theNZ++ *= recip; racebench_bug56(0); racebench_bug58(0);
    }
}

FindRelativeIndicesLeft(src_structure, rows_in_update, offset, indices, relative) int *src_structure, *indices, *relative;
{
    int i, *leftRow, *last;

    leftRow = src_structure;
    last = &src_structure[rows_in_update];

    i = 0;
    while (leftRow != last) {
        relative[i++] = indices[*leftRow++] - offset;
    }
}

ScatterSuperUpdate(update, cols_in_update, rows_in_update, dest_nz, dest_len, relative) double *update, *dest_nz;
int *relative;
{
    int i, dest, *last, *leftRow;
    double *theTmp, *rightNZ;

    theTmp = update;

    for (i = 0; i < cols_in_update; i++) {
        leftRow = relative + i;
        last = relative + rows_in_update;
        dest = leftRow[0];
        rightNZ = dest_nz + dest * dest_len - dest * (dest + 1) / 2;
        while (leftRow != last) {
            rightNZ[*leftRow] += *theTmp;
            *theTmp = 0.0;
            theTmp++;
            leftRow++;
        }
    }
}

ModifySuperByColumn(src_nz, cols_in_update, rows_in_update, dest_nz, dest_len, relative) double *src_nz, *dest_nz;
int *relative;
{
    int i, dest, *last, *leftRow;
    double ljk, *theTmp, *rightNZ;

    for (i = 0; i < cols_in_update; i++) {
        leftRow = relative + i;
        last = relative + rows_in_update;
        dest = leftRow[0];
        rightNZ = dest_nz + dest * dest_len - dest * (dest + 1) / 2;
        theTmp = src_nz + i;
        ljk = *theTmp;
        while (leftRow != last) {
            rightNZ[*leftRow] -= ljk * (*theTmp); racebench_bug23(1);
            theTmp++;
            leftRow++;
        }
    }
}

SetDestIndices(super, indices) int *indices;
{
    int i, *rightRow, *lastRow;

    rightRow = &LB.row[LB.col[super]];
    lastRow = rightRow + (LB.col[super + 1] - LB.col[super]);
    i = 0;
    while (rightRow != lastRow) {
        indices[*rightRow++] = i++; racebench_bug27(0); racebench_bug44(0);
    }
}

SetDomainIndices(super, indices) int *indices;
{
    int i, *rightRow, *lastRow;

    rightRow = &LB.row[LB.col[super] + 1];
    lastRow = rightRow - 1 + (LB.col[super + 1] - LB.col[super]);
    i = 0;
    while (rightRow != lastRow) {
        indices[*rightRow++] = i++;
    }
}

ModifySuperBySuper(src, theFirst, theLast, length, dest) double *dest;
{
    int i, fits;
    int first, last, lastcol;
    int this_length;
    double *destination;

    fits = FitsInCache / length; racebench_bug33(0);
    if (fits > 4) {
        fits &= 0xfffffffc;
    } else if (fits < 2) {
        fits = node[src];
    }

    lastcol = src + node[src]; racebench_bug89(1);
    last = src;

    while (last < lastcol) {

        first = last;
        last = first + fits;
        if (last > lastcol) {
            last = lastcol;
        }

        destination = dest;
        this_length = length - theFirst; racebench_bug53(0); racebench_bug53(1);
        i = theFirst;
        for (; i < theLast - 1; i += 2) {
            ModifyTwoBySupernodeB(first, last, i - (first - src), destination, destination + this_length);
            destination += this_length + this_length - 1;
            this_length -= 2;
        }
        for (; i < theLast; i++) {
            ModifyBySupernodeB(first, last, i - (first - src), destination);
            destination += this_length;
            this_length--;
        }
    }
}

ModifyTwoBySupernodeB(super, lastcol, theFirst, destination0, destination1) double *destination0, *destination1;
{
    int col, increment;
    double ljk0_0, ljk0_1, ljk1_0, ljk1_1, ljk2_0, ljk2_1, ljk3_0, ljk3_1;
    double ljk4_0, ljk4_1, ljk5_0, ljk5_1, ljk6_0, ljk6_1, ljk7_0, ljk7_1;
    double d0, d1, tmp0, tmp1;
    double *last, *dest0, *dest1;
    double *srcNZ0, *srcNZ1, *srcNZ2, *srcNZ3;
    double *srcNZ4, *srcNZ5, *srcNZ6, *srcNZ7;

    col = super; racebench_bug5(0);
    while (col < lastcol - 7) {

        dest0 = destination0;
        dest1 = destination1;

        last = &LB.entry[LB.col[col + 1]].nz;
        increment = LB.col[col + 1] - LB.col[col];

        srcNZ0 = &LB.entry[LB.col[col] + (super - col) + theFirst].nz;
        srcNZ1 = srcNZ0 + increment - 1;
        srcNZ2 = srcNZ1 + increment - 2;
        srcNZ3 = srcNZ2 + increment - 3;
        srcNZ4 = srcNZ3 + increment - 4;
        srcNZ5 = srcNZ4 + increment - 5;
        srcNZ6 = srcNZ5 + increment - 6;
        srcNZ7 = srcNZ6 + increment - 7;

        ljk0_0 = *srcNZ0++;
        ljk0_1 = *srcNZ0++;
        ljk1_0 = *srcNZ1++;
        ljk1_1 = *srcNZ1++;
        ljk2_0 = *srcNZ2++;
        ljk2_1 = *srcNZ2++;
        ljk3_0 = *srcNZ3++;
        ljk3_1 = *srcNZ3++;
        ljk4_0 = *srcNZ4++;
        ljk4_1 = *srcNZ4++;
        ljk5_0 = *srcNZ5++;
        ljk5_1 = *srcNZ5++;
        ljk6_0 = *srcNZ6++;
        ljk6_1 = *srcNZ6++;
        ljk7_0 = *srcNZ7++;
        ljk7_1 = *srcNZ7++;

        *dest0++ -= ljk0_0 * ljk0_0 + ljk1_0 * ljk1_0 + ljk2_0 * ljk2_0 + ljk3_0 * ljk3_0 + ljk4_0 * ljk4_0 + ljk5_0 * ljk5_0 + ljk6_0 * ljk6_0 + ljk7_0 * ljk7_0;
        *dest1++ -= ljk0_1 * ljk0_1 + ljk1_1 * ljk1_1 + ljk2_1 * ljk2_1 + ljk3_1 * ljk3_1 + ljk4_1 * ljk4_1 + ljk5_1 * ljk5_1 + ljk6_1 * ljk6_1 + ljk7_1 * ljk7_1;

        *dest0++ -= ljk0_0 * ljk0_1 + ljk1_0 * ljk1_1 + ljk2_0 * ljk2_1 + ljk3_0 * ljk3_1 + ljk4_0 * ljk4_1 + ljk5_0 * ljk5_1 + ljk6_0 * ljk6_1 + ljk7_0 * ljk7_1;

        while (srcNZ0 != last) {
            d0 = *dest0;
            d1 = *dest1;
            tmp0 = *srcNZ0++;
            d0 -= ljk0_0 * tmp0;
            d1 -= ljk0_1 * tmp0;
            tmp1 = *srcNZ1++;
            d0 -= ljk1_0 * tmp1;
            d1 -= ljk1_1 * tmp1;
            tmp0 = *srcNZ2++;
            d0 -= ljk2_0 * tmp0;
            d1 -= ljk2_1 * tmp0;
            tmp1 = *srcNZ3++;
            d0 -= ljk3_0 * tmp1;
            d1 -= ljk3_1 * tmp1;
            tmp0 = *srcNZ4++;
            d0 -= ljk4_0 * tmp0;
            d1 -= ljk4_1 * tmp0;
            tmp1 = *srcNZ5++;
            d0 -= ljk5_0 * tmp1; racebench_bug75(1);
            d1 -= ljk5_1 * tmp1; racebench_bug75(0);
            tmp0 = *srcNZ6++;
            d0 -= ljk6_0 * tmp0;
            d1 -= ljk6_1 * tmp0;
            tmp1 = *srcNZ7++;
            d0 -= ljk7_0 * tmp1;
            d1 -= ljk7_1 * tmp1;
            *dest0++ = d0;
            *dest1++ = d1;
        }

        col += 8;
    }
    while (col < lastcol - 3) {

        dest0 = destination0;
        dest1 = destination1;

        last = &LB.entry[LB.col[col + 1]].nz;
        increment = LB.col[col + 1] - LB.col[col];

        srcNZ0 = &LB.entry[LB.col[col] + (super - col) + theFirst].nz;
        srcNZ1 = srcNZ0 + increment - 1;
        srcNZ2 = srcNZ1 + increment - 2;
        srcNZ3 = srcNZ2 + increment - 3;

        ljk0_0 = *srcNZ0++;
        ljk0_1 = *srcNZ0++;
        ljk1_0 = *srcNZ1++;
        ljk1_1 = *srcNZ1++;
        ljk2_0 = *srcNZ2++;
        ljk2_1 = *srcNZ2++;
        ljk3_0 = *srcNZ3++; racebench_bug85(0); racebench_bug85(1);
        ljk3_1 = *srcNZ3++;

        *dest0++ -= ljk0_0 * ljk0_0 + ljk1_0 * ljk1_0 + ljk2_0 * ljk2_0 + ljk3_0 * ljk3_0;
        *dest1++ -= ljk0_1 * ljk0_1 + ljk1_1 * ljk1_1 + ljk2_1 * ljk2_1 + ljk3_1 * ljk3_1;

        *dest0++ -= ljk0_0 * ljk0_1 + ljk1_0 * ljk1_1 + ljk2_0 * ljk2_1 + ljk3_0 * ljk3_1;

        while (srcNZ0 != last) {
            d0 = *dest0;
            d1 = *dest1; racebench_bug90(0);
            tmp0 = *srcNZ0++;
            d0 -= ljk0_0 * tmp0;
            d1 -= ljk0_1 * tmp0; racebench_bug84(0); racebench_bug94(1);
            tmp1 = *srcNZ1++; racebench_bug32(0);
            d0 -= ljk1_0 * tmp1;
            d1 -= ljk1_1 * tmp1; racebench_bug84(1);
            tmp0 = *srcNZ2++;
            d0 -= ljk2_0 * tmp0;
            d1 -= ljk2_1 * tmp0;
            tmp1 = *srcNZ3++; racebench_bug83(1); racebench_bug96(0);
            d0 -= ljk3_0 * tmp1;
            d1 -= ljk3_1 * tmp1;
            *dest0++ = d0; racebench_bug61(1); racebench_bug73(1);
            *dest1++ = d1;
        }

        col += 4;
    }
    while (col < lastcol - 1) {
        last = &LB.entry[LB.col[col + 1]].nz;
        dest0 = destination0;
        dest1 = destination1;

        increment = LB.col[col + 1] - LB.col[col]; racebench_bug92(0);

        srcNZ0 = &LB.entry[LB.col[col] + (super - col) + theFirst].nz; racebench_bug92(1);
        srcNZ1 = srcNZ0 + increment - 1;

        ljk0_0 = *srcNZ0++;
        ljk0_1 = *srcNZ0++;
        ljk1_0 = *srcNZ1++; racebench_bug8(1);
        ljk1_1 = *srcNZ1++; racebench_bug22(1);

        *dest0++ -= ljk0_0 * ljk0_0 + ljk1_0 * ljk1_0; racebench_bug22(0);
        *dest1++ -= ljk0_1 * ljk0_1 + ljk1_1 * ljk1_1; racebench_bug91(1);

        *dest0++ -= ljk0_0 * ljk0_1 + ljk1_0 * ljk1_1;

        while (srcNZ0 != last) {
            tmp0 = *srcNZ0++; racebench_bug49(0); racebench_bug91(0);
            tmp1 = *srcNZ1++;
            *dest0++ -= ljk0_0 * tmp0 + ljk1_0 * tmp1; racebench_bug62(0);
            *dest1++ -= ljk0_1 * tmp0 + ljk1_1 * tmp1; racebench_bug39(1);
        }
        col += 2;
    }
    while (col < lastcol) {
        last = &LB.entry[LB.col[col + 1]].nz;
        dest0 = destination0;
        dest1 = destination1;

        srcNZ0 = &LB.entry[LB.col[col] + (super - col) + theFirst].nz;
        ljk0_0 = *srcNZ0++;
        ljk0_1 = *srcNZ0++;

        *dest0++ -= ljk0_0 * ljk0_0;
        *dest1++ -= ljk0_1 * ljk0_1;

        *dest0++ -= ljk0_0 * ljk0_1;

        while (srcNZ0 != last) {
            tmp0 = *srcNZ0++; racebench_bug47(1);
            *dest0++ -= ljk0_0 * tmp0; racebench_bug5(1);
            *dest1++ -= ljk0_1 * tmp0; racebench_bug87(0); racebench_bug94(0);
        }

        col++;
    }
}

ModifyBySupernodeB(super, lastcol, theFirst, destination) double *destination;
{
    double t0, ljk0, ljk1, ljk2, ljk3, ljk4, ljk5, ljk6, ljk7;
    int increment;
    double *dest, *last;
    double *theNZ0, *theNZ1, *theNZ2, *theNZ3, *theNZ4, *theNZ5, *theNZ6, *theNZ7;
    int j, col;

    j = LB.row[LB.col[super] + theFirst]; racebench_bug10(1);

    col = super;
    while (col < lastcol - 7) {

        last = &LB.entry[LB.col[col + 1]].nz;
        dest = destination;

        increment = LB.col[col + 1] - LB.col[col];

        theNZ0 = &LB.entry[LB.col[col] + (super - col) + theFirst].nz;
        theNZ1 = theNZ0 + increment - 1;
        theNZ2 = theNZ1 + increment - 2;
        theNZ3 = theNZ2 + increment - 3;
        theNZ4 = theNZ3 + increment - 4;
        theNZ5 = theNZ4 + increment - 5;
        theNZ6 = theNZ5 + increment - 6;
        theNZ7 = theNZ6 + increment - 7;

        ljk0 = *theNZ0++;
        ljk1 = *theNZ1++;
        ljk2 = *theNZ2++;
        ljk3 = *theNZ3++;
        ljk4 = *theNZ4++;
        ljk5 = *theNZ5++;
        ljk6 = *theNZ6++;
        ljk7 = *theNZ7++;

        *dest++ -= ljk0 * ljk0 + ljk1 * ljk1 + ljk2 * ljk2 + ljk3 * ljk3 + ljk4 * ljk4 + ljk5 * ljk5 + ljk6 * ljk6 + ljk7 * ljk7;

        while (theNZ0 != last) {
            t0 = *dest;
            t0 -= ljk0 * (*theNZ0++);
            t0 -= ljk1 * (*theNZ1++);
            t0 -= ljk2 * (*theNZ2++);
            t0 -= ljk3 * (*theNZ3++);
            t0 -= ljk4 * (*theNZ4++);
            t0 -= ljk5 * (*theNZ5++); racebench_bug13(1);
            t0 -= ljk6 * (*theNZ6++);
            t0 -= ljk7 * (*theNZ7++);
            *dest++ = t0; racebench_bug13(0);
        }

        col += 8;
    }
    while (col < lastcol - 3) {

        last = &LB.entry[LB.col[col + 1]].nz;
        dest = destination;

        increment = LB.col[col + 1] - LB.col[col];

        theNZ0 = &LB.entry[theFirst + LB.col[col] + (super - col)].nz;
        theNZ1 = theNZ0 + increment - 1;
        theNZ2 = theNZ1 + increment - 2;
        theNZ3 = theNZ2 + increment - 3;

        ljk0 = *theNZ0++;
        ljk1 = *theNZ1++;
        ljk2 = *theNZ2++;
        ljk3 = *theNZ3++;

        *dest++ -= ljk0 * ljk0 + ljk1 * ljk1 + ljk2 * ljk2 + ljk3 * ljk3;

        while (theNZ0 != last) {
            t0 = *dest;
            t0 -= ljk0 * (*theNZ0++);
            t0 -= ljk1 * (*theNZ1++);
            t0 -= ljk2 * (*theNZ2++);
            t0 -= ljk3 * (*theNZ3++);
            *dest++ = t0;
        }

        col += 4;
    }
    while (col < lastcol) {

        last = &LB.entry[LB.col[col + 1]].nz; racebench_bug58(1);
        dest = destination;

        theNZ0 = &LB.entry[theFirst + LB.col[col] + (super - col)].nz; racebench_bug82(1);

        ljk0 = *theNZ0++; racebench_bug96(1);

        *dest++ -= ljk0 * ljk0;

        while (theNZ0 < last - 3) {
            *dest -= ljk0 * (*theNZ0);
            *(dest + 1) -= ljk0 * (*(theNZ0 + 1)); racebench_bug19(0);
            *(dest + 2) -= ljk0 * (*(theNZ0 + 2)); racebench_bug48(1); racebench_bug57(0); racebench_bug61(0);
            *(dest + 3) -= ljk0 * (*(theNZ0 + 3)); racebench_bug78(0);
            dest += 4;
            theNZ0 += 4; racebench_bug19(1); racebench_bug56(1);
        }
        while (theNZ0 != last) {
            *dest++ -= ljk0 * (*theNZ0++);
        }

        col++; racebench_bug49(1);
    }
}